<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>US Signal | On-Call Schedule</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <link rel="icon" href="./ussignal.jpg" type="image/jpeg" />
  <link rel="stylesheet" href="style.css" />

  <!-- =========================
       PUBLIC UI ENHANCEMENTS Completed
  ========================= -->
  <style>
 /* ===== PAY REQUEST BUTTON (US SIGNAL NAVY) ===== */
.pay-request-btn {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  padding: 9px 16px;
  border-radius: 999px;
  background: linear-gradient(135deg,#0b2d5b,#123a6f);
  color: #ffffff;
  font-weight: 600;
  font-size: 13px;
  letter-spacing: 0.2px;
  text-decoration: none;
  box-shadow: 0 1px 2px rgba(0,0,0,.12), inset 0 0 0 1px rgba(255,255,255,.08);
  white-space: nowrap;
}
.pay-request-btn:hover { background: linear-gradient(135deg,#09254b,#0b2d5b); }
.pay-request-btn:active { transform: translateY(1px); }
.pay-request-btn:focus-visible {
  outline: 3px solid rgba(11, 45, 91, 0.45);
  outline-offset: 2px;
}

/* ===== PUBLIC TABS ===== */
.tabs {
  display: flex;
  gap: 6px;
  padding: 10px;
  background: var(--card);
  border-radius: 12px;
  margin-bottom: 16px;
  overflow-x: auto;
}
.tabs button {
  flex: 1;
  padding: 10px 14px;
  border-radius: 10px;
  font-weight: 600;
  background: transparent;
  border: none;
  cursor: pointer;
}

/* ===== PANEL ANIMATION ===== */
.panel {
  display: none;
  opacity: 0;
  transform: translateY(6px);
  transition: opacity 200ms ease, transform 200ms ease;
}
.panel.active {
  display: block;
  opacity: 1;
  transform: translateY(0);
}

/* ===== TIMELINE ROW ANIMATION ===== */
#timeline > * {
  opacity: 0;
  transform: translateY(8px);
  transition: opacity 260ms ease, transform 260ms ease;
}
#timeline > *.animate-in {
  opacity: 1;
  transform: translateY(0);
}

/* ===== TODAY PULSE ===== */
@keyframes todayPulse {
  0% { box-shadow: 0 0 0 0 rgba(14,165,233,.45); }
  70% { box-shadow: 0 0 0 10px rgba(14,165,233,0); }
  100% { box-shadow: 0 0 0 0 rgba(14,165,233,0); }
}
.today-indicator {
  position: relative;
  border-radius: 12px;
  animation: todayPulse 2.4s infinite;
}

/* ===== MOBILE OPTIMIZATION ===== */
@media (max-width: 768px) {
  .controls { flex-wrap: wrap; gap: 8px; }
  .pay-request-btn { width: 100%; justify-content: center; }
}

/* ===== LIVE CARD ===== */
.live-card {
  border-left: 6px solid #0ea5e9;
  background: linear-gradient(90deg, rgba(14,165,233,.08), transparent);
  padding: 14px;
  border-radius: 12px;
  margin-bottom: 16px;
}
.subtle { color: var(--muted); font-size: 13px; }

/* ===== US SIGNAL TAB STYLING FIX ===== */
:root {
  --us-navy: #0b2d5b;
  --us-navy-soft: #e6eef8;
}
.tabs button.tab {
  color: #374151;
  background: transparent;
  border-radius: 10px;
  font-weight: 600;
  transition: background 120ms ease, color 120ms ease;
}
.tabs button.tab:not(.active):hover {
  background: rgba(11, 45, 91, 0.08);
  color: var(--us-navy);
}
.tabs button.tab.active {
  background: var(--us-navy-soft);
  color: var(--us-navy);
  box-shadow: inset 0 -3px 0 var(--us-navy);
}
.tabs button.tab:focus-visible {
  outline: 3px solid rgba(11, 45, 91, 0.4);
  outline-offset: 2px;
}
    /* ===== Schedule Fixing ===== */
  .schedule-card.archived {
  opacity: 0.55;
  filter: grayscale(0.3);
}

.archived-badge {
  margin-left: 8px;
  padding: 2px 8px;
  font-size: 11px;
  font-weight: 600;
  border-radius: 999px;
  background: #e5e7eb;
  color: #374151;
}
    /* ===== TIMELINE PERSON DETAIL FIX ===== */

.timeline-track {
  display: flex;
  gap: 12px;
  flex-wrap: wrap;
}

.timeline-block {
  background: #ffffff;
  border-radius: 10px;
  padding: 10px 12px;
  min-width: 220px;
  box-shadow: 0 1px 2px rgba(0,0,0,.06);
  border: 1px solid rgba(0,0,0,.05);
}

.timeline-dept {
  font-size: 12px;
  font-weight: 700;
  color: #0b2d5b;
  margin-bottom: 4px;
}

.timeline-name {
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 2px;
}

.timeline-email {
  font-size: 12px;
  color: #374151;
  word-break: break-all;
}

.timeline-phone {
  font-size: 12px;
  color: #2563eb;
  text-decoration: none;
}

.timeline-phone:hover {
  text-decoration: underline;
}
.archived-wrapper {
  margin-top: 20px;
}

.archived-wrapper summary {
  cursor: pointer;
  font-weight: 700;
  font-size: 14px;
  color: #0b2d5b;
  padding: 10px 12px;
  border-radius: 10px;
  background: #eef4fb;
  list-style: none;
}

.archived-wrapper summary::-webkit-details-marker {
  display: none;
}

.archived-list {
  margin-top: 12px;
}
  </style>
</head>

<body class="light">

<header class="topbar">
  <div class="brand">
    <img src="ussignal.jpg" alt="US Signal" class="logo" />
    <div>
      <div class="brand-title">US Signal</div>
      <div class="brand-sub">Solution Provider On-Call Schedule</div>
    </div>
  </div>

  <div class="controls">
    <button id="themeToggle" class="ghost" aria-label="Toggle light or dark mode">ðŸŒ™</button>

    <select id="deptFilter" aria-label="Filter by department">
      <option value="all">All Departments</option>
      <option value="enterprise_network">Enterprise Network</option>
      <option value="collaboration">Collaboration</option>
      <option value="system_storage">System & Storage</option>
    </select>

    <a href="https://forms.microsoft.com/Pages/ResponsePage.aspx?id=2kFZU3Lai0qDeJg6VL7DQmcodVUCw2tHgn0S1PzMbxpUQ0NXTlQ5TEtERzE0RzNHN0tNMjJNWThWRS4u"
       target="_blank" rel="noopener"
       class="pay-request-btn"
       aria-label="Submit US Signal On-Call Pay Request">
      ðŸ’¼ On-Call Pay Request
    </a>
  </div>
</header>

<nav class="tabs" role="tablist">
  <button class="tab active" data-tab="scheduleTab">Full Schedule</button>
  <button class="tab" data-tab="currentTab">Whoâ€™s On Call Now</button>
  <button class="tab" data-tab="psCustomersTab">OneAssist Customers</button>
</nav>

<main class="container">

  <section id="scheduleTab" class="panel active" role="tabpanel">
    <h2>Full Schedule</h2>
    <div id="schedule"></div>
  </section>

  <section id="currentTab" class="panel" role="tabpanel">
    <div class="panel-head">
      <h2>Whoâ€™s On Call Now</h2>
      <div class="subtle">Live Â· Read-only Â· Auto-updated</div>
    </div>
    <div id="currentOnCall" class="live-card"></div>
  </section>
  
  <section id="psCustomersTab" class="panel" role="tabpanel">
  <h2>OneAssist Customers</h2>
  <div class="subtle" style="margin-bottom:10px">
    Read-only reference Â· PINs used for IVR  authentication
  </div>

  <div id="psCustomers"></div>
  </section>

</main>

<div id="toast" class="toast hidden" role="status" aria-live="polite"></div>

<script type="module" src="public.js"></script>


<!-- ===== ADVANCED INTERACTION LAYER ===== -->
<script>
(function () {
  const tabs = Array.from(document.querySelectorAll(".tabs .tab"));
  const panels = Array.from(document.querySelectorAll(".panel"));

  function activate(tabName, updateHash = true) {
    tabs.forEach(t => t.classList.toggle("active", t.dataset.tab === tabName));
    panels.forEach(p => p.classList.toggle("active", p.id === tabName));
    if (updateHash) history.replaceState(null, "", "#" + tabName.replace("Tab",""));
  }

  tabs.forEach(btn => btn.addEventListener("click", () => activate(btn.dataset.tab)));

  /* ===== KEYBOARD NAV ===== */
  document.addEventListener("keydown", e => {
    const active = tabs.findIndex(t => t.classList.contains("active"));
    if (e.key === "ArrowRight" && tabs[active+1]) activate(tabs[active+1].dataset.tab);
    if (e.key === "ArrowLeft" && tabs[active-1]) activate(tabs[active-1].dataset.tab);
    if (e.key === "Home") activate("scheduleTab");
    if (e.key === "End") activate("currentTab");

  });

  /* ===== VELOCITY SWIPE (TABS) ===== */
  let sx=0, st=0;
  document.addEventListener("touchstart", e => {
    sx = e.touches[0].clientX;
    st = Date.now();
  }, { passive:true });

  document.addEventListener("touchend", e => {
    const dx = e.changedTouches[0].clientX - sx;
    const dt = Date.now() - st;
    const velocity = Math.abs(dx / dt);
    if (Math.abs(dx) > 60 && velocity > 0.35) {
      const i = tabs.findIndex(t => t.classList.contains("active"));
      const next = dx < 0 ? i+1 : i-1;
      if (tabs[next]) activate(tabs[next].dataset.tab);
    }
  });

  /* ===== TIMELINE OBSERVER + WEEK SWIPE ===== */
const targets = [
  document.getElementById("timeline"),
  document.getElementById("schedule")
].filter(Boolean);

targets.forEach(container => {
  const obs = new MutationObserver(() => {
    const current =
      container.querySelector(".current-oncall") ||
      container.querySelector("[data-current-week='true']");
    if (current) {
      current.scrollIntoView({ behavior: "smooth", block: "center" });
    }
  });
  obs.observe(container, { childList: true, subtree: true });
});


  const obs = new MutationObserver(() => {
    Array.from(timeline.children).forEach((r,i)=>{
      setTimeout(()=>r.classList.add("animate-in"),i*35);
    });
    const today =
      timeline.querySelector(".current-week") ||
      timeline.querySelector("[data-current-week='true']");
    if (today) {
      today.classList.add("today-indicator");
      today.scrollIntoView({ behavior:"smooth", block:"center" });
    }
  });
  obs.observe(timeline,{childList:true});

  let tsx=0;
  timeline.addEventListener("touchstart",e=>tsx=e.touches[0].clientX,{passive:true});
  timeline.addEventListener("touchend",e=>{
    const dx=e.changedTouches[0].clientX-tsx;
    if(Math.abs(dx)>80){
      timeline.dispatchEvent(new CustomEvent(dx<0?"timeline:next":"timeline:prev"));
    }
  });

})();
</script>

</body>
</html>
