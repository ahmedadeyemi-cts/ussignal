<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>US Signal | On-Call Administration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Favicon -->
  <link rel="icon" href="./ussignal.jpg" type="image/jpeg" />

  <!-- Core Styles -->
  <link rel="stylesheet" href="style.css" />
</head>

<body class="light">

<!-- =========================
     TOP BAR
========================= -->
<header class="topbar">
  <div class="brand">
    <img src="ussignal.jpg" alt="US Signal" class="logo" />
    <div>
      <div class="brand-title">US Signal</div>
      <div class="brand-sub">On-Call Administration</div>
    </div>
  </div>

  <!-- Controls MUST exist for app.js -->
  <div class="controls">
    <select id="deptFilter" aria-label="Department Filter">
      <option value="all">All Departments</option>
      <option value="enterprise_network">Enterprise Network</option>
      <option value="collaboration">Collaboration</option>
      <option value="system_storage">System & Storage</option>
    </select>

    <button id="saveAllBtn" class="primary">Save</button>
    <button id="revertBtn" class="ghost">Revert</button>
    <button id="notifyBtn" class="ghost">Notify</button>
    <button id="exportBtn" class="ghost">Export Excel</button>
    <button id="icsBtn" class="ghost">ICS</button>
  </div>
</header>

<!-- =========================
     TABS (wireTabs depends on this)
========================= -->
<nav class="tabs" role="tablist">
  <button class="tab active" data-tab="scheduleTab" role="tab">Schedule</button>
  <button class="tab" data-tab="timelineTab" role="tab">Timeline</button>
  <button class="tab" data-tab="rosterTab" role="tab">Roster</button>
  <button class="tab" data-tab="autogenTab" role="tab">Auto-Generate</button>
  <button class="tab" data-tab="auditTab" role="tab">Audit</button>
</nav>

<!-- =========================
     MAIN CONTENT
========================= -->
<main class="container">

  <!-- Schedule -->
  <section id="scheduleTab" class="panel active" role="tabpanel">
    <div id="schedule"></div>
  </section>

  <!-- Timeline -->
  <section id="timelineTab" class="panel" role="tabpanel">
    <h2>Weekly Timeline</h2>
    <div id="timeline"></div>
  </section>

  <!-- Roster -->
  <section id="rosterTab" class="panel" role="tabpanel">
    <div class="panel-head">
      <h2>Roster Management</h2>
      <div>
        <button id="rosterAddUserBtn" class="primary">Add User</button>
        <button id="rosterSaveBtn" class="ghost">Save</button>
        <button id="rosterReloadBtn" class="ghost">Reload</button>
      </div>
    </div>
    <div id="roster"></div>
  </section>

  <!-- Auto-Generate -->
  <section id="autogenTab" class="panel" role="tabpanel">
    <h2>Auto-Generate Schedule</h2>
    <div class="form-row">
      <label for="autogenStart">Start</label>
      <input type="date" id="autogenStart" />

      <label for="autogenEnd">End</label>
      <input type="date" id="autogenEnd" />

      <label for="autogenSeed">Seed</label>
      <input type="number" id="autogenSeed" value="0" />

      <button id="runAutogenBtn" class="primary">Run</button>
    </div>
  </section>

  <!-- Audit -->
  <section id="auditTab" class="panel" role="tabpanel">
    <div class="panel-head">
      <h2>Audit Log</h2>
      <button id="auditRefreshBtn" class="ghost">Refresh</button>
    </div>
    <div id="audit"></div>
  </section>

</main>

<!-- =========================
     MODAL (required)
========================= -->
<div id="modal" class="modal hidden" aria-hidden="true">
  <div class="modal-card">
    <div class="modal-head">
      <h3 id="modalTitle"></h3>
      <button id="modalClose" aria-label="Close">✕</button>
    </div>
    <div id="modalBody" class="modal-body"></div>
    <div class="modal-actions">
      <button id="modalCancel" class="ghost">Cancel</button>
      <button id="modalOk" class="primary">OK</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div id="toast" class="toast hidden" role="status"></div>

<!-- =========================
     APP SCRIPT
========================= -->
<script src="/app.js" defer></script>
<script>
  // Cloudflare Access injects context into window.__CTX__
  window.addEventListener("DOMContentLoaded", () => {
    if (typeof initApp === "function") {
      initApp(window.__CTX__ || {});
    } else {
      console.error("initApp() not found — app.js failed to load.");
    }
  });
</script>

</body>
</html>
