<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>US Signal | On-Call Administration</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Favicon -->
  <link rel="icon" href="./ussignal.jpg" type="image/jpeg" />

  <!-- Core Styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- Modal Enhancements (safe to inline) -->
  <style>
    /* ===== Modal Animation ===== */
    .modal {
      opacity: 0;
      pointer-events: none;
      transition: opacity 160ms ease;
    }
    .modal.modal-open {
      opacity: 1;
      pointer-events: auto;
    }
    .modal-card {
      transform: translateY(12px) scale(0.98);
      opacity: 0;
      transition: transform 180ms ease, opacity 180ms ease;
    }
    .modal.modal-open .modal-card {
      transform: translateY(0) scale(1);
      opacity: 1;
    }

    /* ===== Inline Validation ===== */
    .field {
      display: flex;
      flex-direction: column;
      gap: 4px;
    }
    .field-error input {
      border-color: #dc2626;
    }
    .field-success input {
      border-color: #16a34a;
    }
    .hint {
      font-size: 12px;
      color: #6b7280;
    }
    .hint.error {
      color: #dc2626;
    }
  </style>
</head>

<body class="light">

<!-- =========================
     TOP BAR
========================= -->
<header class="topbar">
  <div class="brand">
    <img src="ussignal.jpg" alt="US Signal" class="logo" />
    <div>
      <div class="brand-title">US Signal</div>
      <div class="brand-sub">On-Call Administration</div>
    </div>
  </div>

  <div class="controls">
    <button id="themeToggle" class="ghost" title="Toggle Light/Dark Mode">ðŸŒ™</button>
    <span id="roleBadge" class="role-badge" aria-label="User Role"></span>

    <select id="deptFilter" aria-label="Department Filter">
      <option value="all">All Departments</option>
      <option value="enterprise_network">Enterprise Network</option>
      <option value="collaboration">Collaboration</option>
      <option value="system_storage">System & Storage</option>
    </select>

    <button id="saveAllBtn" class="primary">Save</button>
    <button id="revertBtn" class="ghost">Revert</button>
    <button id="notifyBtn" class="ghost">Notify</button>
    <button id="exportBtn" class="ghost">Export Excel</button>
    <button id="icsBtn" class="ghost">ICS</button>
  </div>
</header>

<!-- =========================
     TABS
========================= -->
<nav class="tabs" role="tablist">
  <button class="tab active" data-tab="scheduleTab" role="tab">Schedule</button>
  <button class="tab" data-tab="timelineTab" role="tab">Timeline</button>
  <button class="tab" data-tab="rosterTab" data-requires="admin" role="tab">Roster</button>
  <button class="tab" data-tab="autogenTab" data-requires="admin" role="tab">Auto-Generate</button>
  <button class="tab" data-tab="auditTab" data-requires="admin" role="tab">Audit</button>
</nav>

<!-- =========================
     MAIN CONTENT
========================= -->
<main class="container">

  <section id="scheduleTab" class="panel active" role="tabpanel">

  <div class="panel-head">
    <h2>On-Call Schedule</h2>
    <div>
      <button id="addScheduleBtn" class="primary">Add Schedule</button>
    </div>
  </div>

  <div id="schedule"></div>
</section>


  <section id="timelineTab" class="panel" role="tabpanel">
    <h2>Weekly Timeline</h2>
    <div id="timeline"></div>
  </section>

  <section id="rosterTab" class="panel" role="tabpanel">
    <div class="panel-head">
      <h2>Roster Management</h2>
      <div>
        <button id="rosterAddUserBtn" class="primary">Add User</button>
        <button id="rosterSaveBtn" class="ghost">Save</button>
        <button id="rosterReloadBtn" class="ghost">Reload</button>
      </div>
    </div>
    <div id="roster"></div>
  </section>

  <section id="autogenTab" class="panel" role="tabpanel">
    <h2>Auto-Generate Schedule</h2>
    <div class="form-row">
      <label for="autogenStart">Start</label>
      <input type="date" id="autogenStart" />

      <label for="autogenEnd">End</label>
      <input type="date" id="autogenEnd" />

      <label for="autogenSeed">Seed</label>
      <input type="number" id="autogenSeed" value="0" />

      <button id="runAutogenBtn" class="primary">Run</button>
    </div>
  </section>

  <section id="auditTab" class="panel" role="tabpanel">
    <div class="panel-head">
      <h2>Audit Log</h2>
      <button id="auditRefreshBtn" class="ghost">Refresh</button>
    </div>
    <div id="audit"></div>
  </section>

  <section id="accessDeniedTab" class="panel" role="tabpanel">
    <div class="access-denied">
      <h2>Access Restricted</h2>
      <p>You do not have permission to view this section.</p>
      <p class="small subtle">Contact an administrator if you believe this is an error.</p>
    </div>
  </section>

</main>

<!-- =========================
     MODAL (ENHANCED)
========================= -->
<div id="modal"
     class="modal hidden"
     role="dialog"
     aria-modal="true"
     tabindex="-1">

  <div class="modal-card modal-card-animate">
    <div class="modal-head">
      <h3 id="modalTitle"></h3>
      <button id="modalClose" aria-label="Close">âœ•</button>
    </div>

    <div id="modalBody" class="modal-body"></div>

    <div class="modal-actions">
      <button id="modalCancel" class="ghost">Cancel</button>
      <button id="modalOk" class="primary">Save</button>
      <button id="modalSaveAddAnother" class="ghost">Save & Add Another</button>
    </div>
  </div>
</div>

<!-- Toast -->
<div id="toast" class="toast hidden" role="status"></div>

<!-- =========================
     APP SCRIPT
========================= -->
<script src="/app.js" defer></script>
<script>
  window.addEventListener("DOMContentLoaded", () => {
    if (typeof initApp === "function") {
      initApp(window.__CTX__ || {});
    } else {
      console.error("initApp() not found â€” app.js failed to load.");
    }
  });
</script>

</body>
</html>
